(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[31],{bwii:function(e,r,t){"use strict";t.r(r),t.d(r,"HomesAroundValueBM",(function(){return B}));var a=t("4G9A"),n=t("/dBk"),o=t.n(n),i=t("qd51"),c=t("mXGw"),s=t.n(c),u=t("TtX5"),p=t("X7wE"),d=t("m6w3"),l=t("gEnB"),f=t.n(l),m=t("Pice"),b=t("Tu0P"),y=t("/ydr"),v={for_sale:m.tb.FOR_SALE,for_rent:m.tb.FOR_RENT,ready_to_build:m.tb.READY_TO_BUILD,sold:m.tb.SOLD},O=function(e){return e&&e.status?v[e.status]:m.tb.FOR_SALE};function _(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?_(Object(t),!0).forEach((function(r){Object(d.a)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g=new b.a,w=Object(y.getLogger)("homesAroundValueService"),j=function(e){return e&&e.location&&e.location.address&&e.location.address.line?e.location.address.line:""},S=function(e){return e&&e.description?e.description:{}},E={query:{primary:!0,status:[m.v,m.ub]},limit:15,offset:0,sort:{field:"list_date",direction:"desc"}},A=function(e){return e-.2*e},k=function(e){return e+.2*e},N=function(){var e=Object(i.a)(o.a.mark((function e(){var r,t,a,n,i,c,s,u,p,d,l,b,y,v=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>0&&void 0!==v[0]?v[0]:{},t=r.params,a=void 0===t?{}:t,n=r.url,i=void 0===n?"".concat(f.a.GATEWAY_URL,"/api/v1/hulk?client_id=rdc-x&schema=vesta"):n,g){e.next=4;break}return w.error("fetchHomesAround called but serviceBase does not exist"),e.abrupt("return",[]);case 4:if(c=a.postal_code,s=a.price,c&&s){e.next=8;break}return w.warn("Failed to fetch homes around missing price or zip code ".concat(JSON.stringify(a))),e.abrupt("return",[]);case 8:return u=h(h({},E),{},{query:h(h({},E.query),{},{postal_code:c,list_price:{min:A(s),max:k(s)}})}),p={callfrom:"LDP",nrQueryType:m.N.HOMES_AROUND_VALUE,query:null,queryLoader:{appType:"FOR_SALE",pageType:"LDP",serviceType:m.N.HOMES_AROUND_VALUE},variables:u},e.prev=10,e.next=13,g.post(i,p);case 13:if(d=e.sent,l=d.result,!(b=d.error)&&l&&l.data&&l.data.home_search){e.next=19;break}return w.error("Failed to fetch homes around  value for ".concat(JSON.stringify(a)),b),e.abrupt("return",[]);case 19:return y=P(l.data.home_search.results),e.abrupt("return",y);case 23:return e.prev=23,e.t0=e.catch(10),w.error("Failed to fetch homes around  value for ".concat(JSON.stringify(a)),e.t0),e.abrupt("return",[]);case 27:case"end":return e.stop()}}),e,null,[[10,23]])})));return function(){return e.apply(this,arguments)}}(),P=function(e){return e&&Array.isArray(e)?e.map((function(e){return{linkObject:{href:e.href||""},data:{price:e.list_price||"",address1:j(e),property_id:e.property_id,status:e.status?e.status:m.v,listing_id:e.listing_id||"",propertyMeta:S(e),type:O(e)},imgSrc:e.primary_photo&&e.primary_photo.href||""}})):(w.warn("massageHomeData was called without a properties collection"),[])},D=t("PssF"),L=t("wlfz"),x=t("nDNw"),R=t("84G6"),F=s.a.createElement,T=function(e){var r=e.data,t=void 0===r?{}:r,a=e.pageName,n=t.data,o=t.imgSrc,i=t.linkObject,c=Object(R.a)(t.data,{pageName:a,trackingLocation:"homes_around_value_bm"}),s=c.savedByMyself,u=c.toggleSavedProperty;return n?F(L.a,{data:n,media:F("img",{src:Object(x.g)(o),alt:"listing"}),linkObject:i,isSaved:s,handleSaveClick:u}):null},H=t("nFh1"),q=s.a.createElement,B=function(e){var r=e.price,t=void 0===r?null:r,n=e.address,s=void 0===n?null:n,d=e.properties,l=void 0===d?[]:d,f=e.propertyId,m=e.pageName,b=Object(c.useState)(l.filter((function(e){return e.data.property_id!==f}))),y=b[0],v=b[1],O=Object(c.useRef)(null);if(Object(c.useEffect)((function(){var e=s&&s.postal_code;t&&e&&function(){var r=Object(i.a)(o.a.mark((function r(){var a,n;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a={postal_code:e,price:t},r.next=3,N({params:a});case 3:(n=r.sent)&&Array.isArray(n)&&v(n.filter((function(e){return e.data.property_id!==f})));case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()()}),[t,s,f]),!y||y.length<5)return null;var _=Object(H.a)(t),h="Homes around ".concat(_),g=y.map((function(e,r){var t=e&&e.data&&e.data.property_id?e.data.property_id:r;return q(u.a,{key:t,className:"rui-browse-module-slide"},q(T,{data:e,pageName:m}))}));return q("div",{ref:O,"data-testid":"homes-around-value-bm"},q(D.a,{placeholderRef:O},q(p.a,{title:h,titleProps:{as:"h2",style:{fontSize:"20px",fontWeight:400}},icon:q(a.IconSimilarHomes,{"data-testid":"icon-similar-homes",size:3})},g)))}}}]);